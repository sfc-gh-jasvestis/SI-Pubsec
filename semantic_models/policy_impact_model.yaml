# Semantic Model for Singapore Policy Impact Analytics
# For use with Cortex Analyst in Snowflake Intelligence Demo

name: "Singapore Policy Impact Analytics"
description: "Analytics model for tracking and measuring the effectiveness of Singapore government policies and initiatives"

tables:
  - name: "policy_performance_analytics"
    description: "Policy implementation tracking and impact measurement"
    base_table:
      database: "SG_PUBSEC_DEMO"
      schema: "ANALYTICS"
      table: "POLICY_PERFORMANCE_ANALYTICS"
    
    dimensions:
      - name: "policy_name"
        synonyms: ["policy", "initiative", "program", "government policy"]
        description: "Name of the government policy or initiative"
        expr: "POLICY_NAME"
        data_type: "text"
        
      - name: "target_demographic"
        synonyms: ["target group", "beneficiary", "target population", "demographic"]
        description: "Target demographic for the policy"
        expr: "TARGET_DEMOGRAPHIC"
        data_type: "text"
        
      - name: "policy_status"
        synonyms: ["status", "implementation status", "policy state"]
        description: "Current status of the policy (Active, Pilot, Rolling Out)"
        expr: "POLICY_STATUS"
        data_type: "text"
        
      - name: "implementation_date"
        synonyms: ["start date", "launch date", "implementation", "policy start"]
        description: "Date when policy was implemented"
        expr: "IMPLEMENTATION_DATE"
        data_type: "date"
        
      - name: "implementation_year"
        synonyms: ["year", "implementation year", "launch year"]
        description: "Year when policy was implemented"
        expr: "IMPLEMENTATION_YEAR"
        data_type: "number"
        
      - name: "implementation_month"
        synonyms: ["month", "implementation month", "launch month"]
        description: "Month when policy was implemented"
        expr: "IMPLEMENTATION_MONTH"
        data_type: "number"
        
      - name: "success_category"
        synonyms: ["success level", "effectiveness", "performance category", "impact level"]
        description: "Categorized success level (Highly Successful, Successful, Moderately Successful, Needs Improvement)"
        expr: "SUCCESS_CATEGORY"
        data_type: "text"

    measures:
      - name: "baseline_metric"
        synonyms: ["baseline", "starting point", "initial value", "before value"]
        description: "Baseline metric value before policy implementation"
        expr: "AVG(BASELINE_METRIC)"
        data_type: "number"
        
      - name: "current_metric"
        synonyms: ["current value", "latest metric", "after value", "current performance"]
        description: "Current metric value after policy implementation"
        expr: "AVG(CURRENT_METRIC)"
        data_type: "number"
        
      - name: "impact_percentage"
        synonyms: ["impact", "improvement", "change percentage", "policy impact"]
        description: "Percentage impact of the policy"
        expr: "AVG(IMPACT_PERCENTAGE)"
        data_type: "number"
        
      - name: "absolute_improvement"
        synonyms: ["improvement", "change", "absolute change", "net improvement"]
        description: "Absolute improvement in metric value"
        expr: "AVG(ABSOLUTE_IMPROVEMENT)"
        data_type: "number"
        
      - name: "roi_percentage"
        synonyms: ["ROI", "return on investment", "effectiveness ratio"]
        description: "Return on investment percentage for the policy"
        expr: "AVG(ROI_PERCENTAGE)"
        data_type: "number"
        
      - name: "days_since_implementation"
        synonyms: ["policy age", "implementation duration", "days running"]
        description: "Average days since policy implementation"
        expr: "AVG(DAYS_SINCE_IMPLEMENTATION)"
        data_type: "number"
        
      - name: "total_policies"
        synonyms: ["policy count", "number of policies", "total initiatives"]
        description: "Total number of policies"
        expr: "COUNT(*)"
        data_type: "number"

    filters:
      - name: "active_policies"
        synonyms: ["active", "current policies", "running policies"]
        description: "Filter for currently active policies"
        expr: "POLICY_STATUS = 'Active'"
        
      - name: "successful_policies"
        synonyms: ["successful", "high impact", "effective policies"]
        description: "Filter for highly successful or successful policies"
        expr: "SUCCESS_CATEGORY IN ('Highly Successful', 'Successful')"
        
      - name: "recent_policies"
        synonyms: ["recent", "new policies", "last year"]
        description: "Filter for policies implemented in the last year"
        expr: "IMPLEMENTATION_DATE >= DATEADD(year, -1, CURRENT_DATE())"
        
      - name: "digital_policies"
        synonyms: ["digital", "technology policies", "digital initiatives"]
        description: "Filter for digital-related policies"
        expr: "POLICY_NAME ILIKE '%Digital%'"
        
      - name: "senior_focused"
        synonyms: ["seniors", "elderly", "senior policies"]
        description: "Filter for policies targeting seniors"
        expr: "TARGET_DEMOGRAPHIC ILIKE '%65+%' OR TARGET_DEMOGRAPHIC ILIKE '%Senior%'"

verified_queries:
  - name: "Digital Inclusion Initiative ROI Analysis"
    question: "What's the ROI of our Digital Inclusion Initiative for seniors?"
    sql: |
      SELECT 
        POLICY_NAME,
        TARGET_DEMOGRAPHIC,
        BASELINE_METRIC,
        CURRENT_METRIC,
        IMPACT_PERCENTAGE,
        ROI_PERCENTAGE,
        DAYS_SINCE_IMPLEMENTATION,
        SUCCESS_CATEGORY
      FROM policy_performance_analytics
      WHERE POLICY_NAME ILIKE '%Digital Inclusion%'
        AND TARGET_DEMOGRAPHIC ILIKE '%65+%'
      ORDER BY IMPACT_PERCENTAGE DESC
    verified_at: "2024-09-22"
    
  - name: "Most Successful Government Policies"
    question: "Which government policies have been most successful this year?"
    sql: |
      SELECT 
        POLICY_NAME,
        TARGET_DEMOGRAPHIC,
        IMPACT_PERCENTAGE,
        ROI_PERCENTAGE,
        SUCCESS_CATEGORY,
        DAYS_SINCE_IMPLEMENTATION
      FROM policy_performance_analytics
      WHERE IMPLEMENTATION_YEAR = 2024
        AND POLICY_STATUS = 'Active'
      ORDER BY IMPACT_PERCENTAGE DESC
      LIMIT 10
    verified_at: "2024-09-22"
    
  - name: "Policy Implementation Timeline and Impact"
    question: "Show me the timeline of policy implementations and their impact over time"
    sql: |
      SELECT 
        IMPLEMENTATION_DATE,
        POLICY_NAME,
        TARGET_DEMOGRAPHIC,
        BASELINE_METRIC,
        CURRENT_METRIC,
        IMPACT_PERCENTAGE,
        SUCCESS_CATEGORY
      FROM policy_performance_analytics
      WHERE IMPLEMENTATION_DATE >= '2024-01-01'
      ORDER BY IMPLEMENTATION_DATE, IMPACT_PERCENTAGE DESC
    verified_at: "2024-09-22"
    
  - name: "Cross-Agency Policy Performance Comparison"
    question: "Compare policy effectiveness across different target demographics"
    sql: |
      SELECT 
        TARGET_DEMOGRAPHIC,
        COUNT(*) as total_policies,
        AVG(IMPACT_PERCENTAGE) as avg_impact,
        AVG(ROI_PERCENTAGE) as avg_roi,
        COUNT(CASE WHEN SUCCESS_CATEGORY IN ('Highly Successful', 'Successful') THEN 1 END) as successful_policies
      FROM policy_performance_analytics
      WHERE POLICY_STATUS = 'Active'
      GROUP BY 1
      ORDER BY avg_impact DESC
    verified_at: "2024-09-22"
    
  - name: "Digital vs Non-Digital Policy Effectiveness"
    question: "How do digital policies compare to traditional policies in terms of impact?"
    sql: |
      SELECT 
        CASE 
          WHEN POLICY_NAME ILIKE '%Digital%' OR POLICY_NAME ILIKE '%AI%' OR POLICY_NAME ILIKE '%Mobile%' 
          THEN 'Digital Policies'
          ELSE 'Traditional Policies'
        END as policy_type,
        COUNT(*) as total_policies,
        AVG(IMPACT_PERCENTAGE) as avg_impact,
        AVG(ROI_PERCENTAGE) as avg_roi,
        AVG(DAYS_SINCE_IMPLEMENTATION) as avg_days_running
      FROM policy_performance_analytics
      WHERE POLICY_STATUS = 'Active'
      GROUP BY 1
      ORDER BY avg_impact DESC
    verified_at: "2024-09-22"
